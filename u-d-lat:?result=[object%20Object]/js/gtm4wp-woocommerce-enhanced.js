function gtm4wp_map_eec_to_ga4(t){if(!t)return;const e=(t.category?t.category:"").toString().split("/");let r={item_id:t.id?t.id:"",item_name:t.name?t.name:"",item_brand:t.brand?t.brand:"",price:t.price?t.price:""};if(1==e.length)r.item_category=e[0];else if(e.length>1){r.item_category=e[0];for(let t=1;t<Math.min(5,e.length);t++)r["item_category"+(t+1)]=e[t]}return t.variant&&(r.item_variant=t.variant),t.list&&(r.item_list_name=t.list),t.position&&(r.index=t.position),t.quantity&&(r.quantity=t.quantity),t.coupon&&(r.coupon=t.coupon),r.google_business_vertical=gtm4wp_business_vertical,r[gtm4wp_business_vertical_id]=gtm4wp_id_prefix+r.item_id,r}function gtm4wp_handle_cart_qty_change(){document.querySelectorAll(".product-quantity input.qty").forEach((function(t){const e=t.defaultValue;let r=parseInt(t.value);if(isNaN(r)&&(r=e),e!=r){const c=t.closest(".cart_item"),a=c&&c.querySelector(".remove");if(!a)return;let o=a.getAttribute("data-gtm4wp_product_price");if("string"==typeof o?(o=parseFloat(o),isNaN(o)&&(o=0)):"number"!=typeof o&&(o=0),e<r){const t={name:a.getAttribute("data-gtm4wp_product_name"),id:a.getAttribute("data-gtm4wp_product_id"),price:o.toFixed(2),category:a.getAttribute("data-gtm4wp_product_cat"),variant:a.getAttribute("data-gtm4wp_product_variant"),stocklevel:a.getAttribute("data-gtm4wp_product_stocklevel"),brand:a.getAttribute("data-gtm4wp_product_brand"),quantity:r-e};window[gtm4wp_datalayer_name].push({event:"gtm4wp.addProductToCartEEC",ecommerce:{currencyCode:gtm4wp_currency,add:{products:[t]}}}),window[gtm4wp_datalayer_name].push({event:"add_to_cart",ecommerce:{currency:gtm4wp_currency,value:o.toFixed(2)*(r-e),items:[gtm4wp_map_eec_to_ga4(t)]}})}else{const t={name:a.getAttribute("data-gtm4wp_product_name"),id:a.getAttribute("data-gtm4wp_product_id"),price:o.toFixed(2),category:a.getAttribute("data-gtm4wp_product_cat"),variant:a.getAttribute("data-gtm4wp_product_variant"),stocklevel:a.getAttribute("data-gtm4wp_product_stocklevel"),brand:a.getAttribute("data-gtm4wp_product_brand"),quantity:e-r};window[gtm4wp_datalayer_name].push({event:"gtm4wp.removeFromCartEEC",ecommerce:{currencyCode:gtm4wp_currency,remove:{products:[t]}}}),window[gtm4wp_datalayer_name].push({event:"remove_from_cart",ecommerce:{currency:gtm4wp_currency,value:o.toFixed(2)*(e-r),items:[gtm4wp_map_eec_to_ga4(t)]}})}}}))}function gtm4wp_handle_payment_method_change(){if(gtm4wp_checkout_step_fired.indexOf("payment_method")>-1)return;if("complete"!=document.readyState)return;let t="(payment type not found)",e=document.querySelector(".payment_methods input:checked");e||(e=document.querySelector("input[name^=payment_method]")),e&&(t=e.value),window[gtm4wp_datalayer_name].push({event:"gtm4wp.checkoutStepEEC",ecommerce:{currencyCode:gtm4wp_currency,checkout:{actionField:{step:4+window.gtm4wp_checkout_step_offset+gtm4wp_shipping_payment_method_step_offset},products:window.gtm4wp_checkout_products}}}),window[gtm4wp_datalayer_name].push({event:"add_payment_info",ecommerce:{currency:gtm4wp_currency,payment_type:t,value:window.gtm4wp_checkout_value,items:window.gtm4wp_checkout_products_ga4}}),gtm4wp_checkout_step_fired.push("payment_method")}function gtm4wp_handle_shipping_method_change(){if(gtm4wp_checkout_step_fired.indexOf("shipping_method")>-1)return;if("complete"!=document.readyState)return;let t="(shipping tier not found)",e=document.querySelector("input[name^=shipping_method]:checked");e||(e=document.querySelector("input[name^=shipping_method]")),e&&(t=e.value),window[gtm4wp_datalayer_name].push({event:"gtm4wp.checkoutStepEEC",ecommerce:{currencyCode:gtm4wp_currency,checkout:{actionField:{step:3+window.gtm4wp_checkout_step_offset+gtm4wp_shipping_payment_method_step_offset},products:window.gtm4wp_checkout_products}}}),window[gtm4wp_datalayer_name].push({event:"add_shipping_info",ecommerce:{currency:gtm4wp_currency,shipping_tier:t,value:window.gtm4wp_checkout_value,items:window.gtm4wp_checkout_products_ga4}}),gtm4wp_checkout_step_fired.push("shipping_method")}function gtm4wp_process_woocommerce_pages(){window.gtm4wp_is_cart=!1,window.gtm4wp_is_checkout=!1;const t=document.querySelector("body");t&&(window.gtm4wp_is_cart=t.classList&&t.classList.contains("woocommerce-cart"),window.gtm4wp_is_checkout=t.classList&&t.classList.contains("woocommerce-checkout"));const e={"wp-block-handpicked-products":{displayname:"Handpicked Products",counter:1},"wp-block-product-best-sellers":{displayname:"Best Selling Products",counter:1},"wp-block-product-category":{displayname:"Product Category List",counter:1},"wp-block-product-new":{displayname:"New Products",counter:1},"wp-block-product-on-sale":{displayname:"Sale Products",counter:1},"wp-block-products-by-attribute":{displayname:"Products By Attribute",counter:1},"wp-block-product-tag":{displayname:"Products By Tag",counter:1},"wp-block-product-top-rated":{displayname:"Top Rated Products",counter:1}};if(document.querySelectorAll(".wc-block-grid .wc-block-grid__product").forEach((function(t){const r=t.closest(".wc-block-grid"),c=t.querySelector(".gtm4wp_productdata");if(r&&c){const t=r.classList;if(t)for(let r in e)t.contains(r)&&(c.setAttribute("data-gtm4wp_productlist_name",e[r].displayname),c.setAttribute("data-gtm4wp_product_listposition",e[r].counter),e[r].counter++)}})),document.querySelectorAll(".gtm4wp_productdata,.widget-product-item").length>0){let t,e=[],c=[],a=0;if(document.querySelectorAll(".gtm4wp_productdata,.widget-product-item").forEach((function(r){a=r.getAttribute("data-gtm4wp_product_price"),"string"==typeof a?(a=parseFloat(a),isNaN(a)&&(a=0)):"number"!=typeof a&&(a=0),t={name:r.getAttribute("data-gtm4wp_product_name"),id:r.getAttribute("data-gtm4wp_product_id"),price:a.toFixed(2),category:r.getAttribute("data-gtm4wp_product_cat"),position:r.getAttribute("data-gtm4wp_product_listposition"),list:r.getAttribute("data-gtm4wp_productlist_name"),stocklevel:r.getAttribute("data-gtm4wp_product_stocklevel"),brand:r.getAttribute("data-gtm4wp_product_brand")},e.push(t),c.push(gtm4wp_map_eec_to_ga4(t))})),gtm4wp_product_per_impression>0){let t,r;for(;e.length;)t=e.splice(0,gtm4wp_product_per_impression),r=c.splice(0,gtm4wp_product_per_impression),window[gtm4wp_datalayer_name].push({event:"gtm4wp.productImpressionEEC",ecommerce:{currencyCode:gtm4wp_currency,impressions:t}}),window[gtm4wp_datalayer_name].push({event:"view_item_list",ecommerce:{currency:gtm4wp_currency,items:r}})}else{for(var r=0;r<window[gtm4wp_datalayer_name].length;r++)if(window[gtm4wp_datalayer_name][r].ecommerce){window[gtm4wp_datalayer_name][r].ecommerce.impressions?window[gtm4wp_datalayer_name][r].ecommerce.impressions=window[gtm4wp_datalayer_name][r].ecommerce.impressions.concat(e):window[gtm4wp_datalayer_name][r].ecommerce.impressions=e;break}r==window[gtm4wp_datalayer_name].length&&(r=0,window[gtm4wp_datalayer_name][r].ecommerce={},window[gtm4wp_datalayer_name][r].ecommerce.impressions=e),window[gtm4wp_datalayer_name][r].ecommerce.currencyCode=gtm4wp_currency}}document.addEventListener("click",(function(t){let e=t.target;if(!e)return!0;try{if(!e.closest(".add_to_cart_button:not(.product_type_variable, .product_type_grouped, .single_add_to_cart_button)"))return!0}catch(t){return!0}const r=e.closest(".product,.wc-block-grid__product"),c=r&&r.querySelector(".gtm4wp_productdata");if(!c)return!0;let a=c.getAttribute("data-gtm4wp_product_price");"string"==typeof a?(a=parseFloat(a),isNaN(a)&&(a=0)):"number"!=typeof a&&(a=0);const o={name:c.getAttribute("data-gtm4wp_product_name"),id:c.getAttribute("data-gtm4wp_product_id"),price:a.toFixed(2),category:c.getAttribute("data-gtm4wp_product_cat"),stocklevel:c.getAttribute("data-gtm4wp_product_stocklevel"),brand:c.getAttribute("data-gtm4wp_product_brand"),quantity:1};window[gtm4wp_datalayer_name].push({event:"gtm4wp.addProductToCartEEC",ecommerce:{currencyCode:gtm4wp_currency,add:{products:[o]}}}),window[gtm4wp_datalayer_name].push({event:"add_to_cart",ecommerce:{currency:gtm4wp_currency,value:a.toFixed(2),items:[gtm4wp_map_eec_to_ga4(o)]}})})),document.addEventListener("click",(function(t){let e=t.target;if(!e)return!0;try{if(!e.closest(".single_add_to_cart_button:not(.disabled)"))return!0}catch(t){return!0}const r=e.closest("form.cart");if(!r)return!0;let c=r.querySelectorAll("[name=variation_id]"),a=r.classList&&r.classList.contains("grouped_form");if(c.length>0){if(gtm4wp_last_selected_product_variation){const t=r.querySelector("[name=quantity]");gtm4wp_last_selected_product_variation.quantity=t&&t.value||1,window[gtm4wp_datalayer_name].push({event:"gtm4wp.addProductToCartEEC",ecommerce:{currencyCode:gtm4wp_currency,add:{products:[gtm4wp_last_selected_product_variation]}}}),window[gtm4wp_datalayer_name].push({event:"add_to_cart",ecommerce:{currency:gtm4wp_currency,value:gtm4wp_last_selected_product_variation.price*gtm4wp_last_selected_product_variation.quantity,items:[gtm4wp_map_eec_to_ga4(gtm4wp_last_selected_product_variation)]}})}}else if(a){const t=document.querySelectorAll(".grouped_form .gtm4wp_productdata");let e=[],r=[],c=0;if(t.forEach((function(t){const a=document.querySelectorAll("input[name=quantity\\["+t.getAttribute("data-gtm4wp_product_internal_id")+"\\]]");if(!(a.length>0))return!0;if(product_qty=a[0]&&a[0].value||1,0==product_qty)return!0;const o={id:gtm4wp_use_sku_instead?t.getAttribute("data-gtm4wp_product_sku"):t.getAttribute("data-gtm4wp_product_id"),name:t.getAttribute("data-gtm4wp_product_name"),price:t.getAttribute("data-gtm4wp_product_price"),category:t.getAttribute("data-gtm4wp_product_cat"),quantity:product_qty,stocklevel:t.getAttribute("data-gtm4wp_product_stocklevel"),brand:t.getAttribute("data-gtm4wp_product_brand")};e.push(o),r.push(gtm4wp_map_eec_to_ga4(o)),c+=o.price*o.quantity})),0==e.length)return!0;window[gtm4wp_datalayer_name].push({event:"gtm4wp.addProductToCartEEC",ecommerce:{currencyCode:gtm4wp_currency,add:{products:e}}}),window[gtm4wp_datalayer_name].push({event:"add_to_cart",ecommerce:{currency:gtm4wp_currency,value:c,items:r}})}else{const t=gtm4wp_use_sku_instead?r.querySelector("[name=gtm4wp_sku]"):r.querySelector("[name=gtm4wp_id]"),e={id:t&&t.value,name:r.querySelector("[name=gtm4wp_name]")&&r.querySelector("[name=gtm4wp_name]").value,price:r.querySelector("[name=gtm4wp_price]")&&r.querySelector("[name=gtm4wp_price]").value,category:r.querySelector("[name=gtm4wp_category]")&&r.querySelector("[name=gtm4wp_category]").value,quantity:r.querySelector("[name=quantity]")&&r.querySelector("[name=quantity]").value,stocklevel:r.querySelector("[name=gtm4wp_stocklevel]")&&r.querySelector("[name=gtm4wp_stocklevel]").value,brand:r.querySelector("[name=gtm4wp_brand]")&&r.querySelector("[name=gtm4wp_brand]").value};window[gtm4wp_datalayer_name].push({event:"gtm4wp.addProductToCartEEC",ecommerce:{currencyCode:gtm4wp_currency,add:{products:[e]}}}),window[gtm4wp_datalayer_name].push({event:"add_to_cart",ecommerce:{currency:gtm4wp_currency,value:e.price*e.quantity,items:[gtm4wp_map_eec_to_ga4(e)]}})}})),document.addEventListener("click",(function(t){let e=t.target;if(e=e&&e.closest(".mini_cart_item a.remove,.product-remove a.remove"),!e)return!0;let r=0;const c=e.closest(".cart_item");let a=c&&c.querySelectorAll(".product-quantity input.qty");if(a&&0!==a.length)r=a[0].value;else{const t=e.closest(".mini_cart_item");a=t&&t.querySelectorAll(".quantity"),a&&a.length>0&&(r=parseInt(a[0].textContent),Number.isNaN(r)&&(r=0))}if(0===r)return!0;const o={name:e.getAttribute("data-gtm4wp_product_name"),id:e.getAttribute("data-gtm4wp_product_id"),price:e.getAttribute("data-gtm4wp_product_price"),category:e.getAttribute("data-gtm4wp_product_cat"),variant:e.getAttribute("data-gtm4wp_product_variant"),stocklevel:e.getAttribute("data-gtm4wp_product_stocklevel"),brand:e.getAttribute("data-gtm4wp_product_brand"),quantity:r};window[gtm4wp_datalayer_name].push({event:"gtm4wp.removeFromCartEEC",ecommerce:{currencyCode:gtm4wp_currency,remove:{products:[o]}}}),window[gtm4wp_datalayer_name].push({event:"remove_from_cart",ecommerce:{currency:gtm4wp_currency,value:o.price*o.quantity,items:[gtm4wp_map_eec_to_ga4(o)]}})}));if(document.addEventListener("click",(function(t){if("undefined"==typeof google_tag_manager)return!0;const e=t.target,r=e.closest(".products li:not(.product-category) a:not(.add_to_cart_button):not(.quick-view-button),.wc-block-grid__products li:not(.product-category) a:not(.add_to_cart_button):not(.quick-view-button),.products>div:not(.product-category) a:not(.add_to_cart_button):not(.quick-view-button),.widget-product-item,.woocommerce-grouped-product-list-item__label a");if(!r)return!0;let c,a=e.closest(".product,.wc-block-grid__product");if(a?c=a.querySelector(".gtm4wp_productdata"):(a=e.closest(".products li"),a?c=a.querySelector(".gtm4wp_productdata"):(a=e.closest(".products>div"),a?c=a.querySelector(".gtm4wp_productdata"):(a=e.closest(".woocommerce-grouped-product-list-item__label"),c=a?a.querySelector(".gtm4wp_productdata"):e))),void 0===c.getAttribute("data-gtm4wp_product_id")||""==c.getAttribute("data-gtm4wp_product_id"))return!0;if(c.getAttribute("data-gtm4wp_product_url")!=r.getAttribute("href"))return!0;const o={id:c.getAttribute("data-gtm4wp_product_id"),name:c.getAttribute("data-gtm4wp_product_name"),price:c.getAttribute("data-gtm4wp_product_price"),category:c.getAttribute("data-gtm4wp_product_cat"),stocklevel:c.getAttribute("data-gtm4wp_product_stocklevel"),brand:c.getAttribute("data-gtm4wp_product_brand"),position:c.getAttribute("data-gtm4wp_product_listposition")};for(let t in window.google_tag_manager)if("gtm-"==t.substring(0,4).toLowerCase()){window.gtm4wp_first_container_id=t;break}if(""===window.gtm4wp_first_container_id)return!0;const n=t.ctrlKey||t.metaKey,i="_blank"===r.target;t.preventDefault(),(n||i)&&(window.productpage_window=window.open("about:blank","_blank")),window[gtm4wp_datalayer_name].push({event:"gtm4wp.productClickEEC",ecommerce:{currencyCode:gtm4wp_currency,click:{actionField:{list:c.getAttribute("data-gtm4wp_productlist_name")},products:[o]}},eventCallback:function(t){if(void 0!==t&&window.gtm4wp_first_container_id!=t)return!0;window[gtm4wp_datalayer_name].push({event:"select_item",ecommerce:{currency:gtm4wp_currency,items:[gtm4wp_map_eec_to_ga4(o)]},eventCallback:function(t){if(void 0!==t&&window.gtm4wp_first_container_id!=t)return!0;(i||n)&&productpage_window?productpage_window.location.href=c.getAttribute("data-gtm4wp_product_url"):document.location.href=c.getAttribute("data-gtm4wp_product_url")},eventTimeout:2e3})},eventTimeout:2e3})})),jQuery(document).on("found_variation",(function(t,e){if(void 0===e)return;if("interactive"===document.readyState&&gtm4wp_changedetail_fired_during_pageload)return;const r=t.target,c=(r.querySelector("[name=variation_id]")&&r.querySelector("[name=variation_id]").value,r.querySelector("[name=gtm4wp_id]")&&r.querySelector("[name=gtm4wp_id]").value,r.querySelector("[name=gtm4wp_name]")&&r.querySelector("[name=gtm4wp_name]").value),a=(r.querySelector("[name=gtm4wp_sku]")&&r.querySelector("[name=gtm4wp_sku]").value,r.querySelector("[name=gtm4wp_category]")&&r.querySelector("[name=gtm4wp_category]").value);r.querySelector("[name=gtm4wp_price]")&&r.querySelector("[name=gtm4wp_price]").value;let o={name:c,id:0,price:0,category:a,stocklevel:r.querySelector("[name=gtm4wp_stocklevel]")&&r.querySelector("[name=gtm4wp_stocklevel]").value,brand:r.querySelector("[name=gtm4wp_brand]")&&r.querySelector("[name=gtm4wp_brand]").value,variant:""};o.id=e.variation_id,gtm4wp_use_sku_instead&&e.sku&&""!==e.sku&&(o.id=e.sku),o.price=e.display_price;let n=[];for(let t in e.attributes)n.push(e.attributes[t]);o.variant=n.join(","),gtm4wp_last_selected_product_variation=o,window[gtm4wp_datalayer_name].push({event:"gtm4wp.changeDetailViewEEC",ecommerce:{currencyCode:gtm4wp_currency,detail:{products:[o]}},ecomm_prodid:gtm4wp_id_prefix+o.id,ecomm_pagetype:"product",ecomm_totalvalue:o.price}),window[gtm4wp_datalayer_name].push({event:"view_item",ecommerce:{currency:gtm4wp_currency,value:o.price,items:[gtm4wp_map_eec_to_ga4(o)]}}),"interactive"===document.readyState&&(gtm4wp_changedetail_fired_during_pageload=!0)})),jQuery(".variations select").trigger("change"),jQuery(document).ajaxSuccess((function(t,e,r){void 0!==r&&r.url.indexOf("wc-api=WC_Quick_View")>-1&&setTimeout((function(){const t=document.querySelector("#gtm4wp_quickview_data");if(t&&t.dataset&&t.dataset.gtm4wp_datalayer)try{const e=JSON.parse(t.dataset.gtm4wp_datalayer);e&&window.dataLayer&&window.dataLayer.push(e)}catch(t){console&&console.error&&console.error(t.message)}}),500)})),gtm4wp_is_cart&&(document.addEventListener("click",(function(t){let e=t.target;return!e||(!e.closest("[name=update_cart]")||void gtm4wp_handle_cart_qty_change())})),document.addEventListener("keypress",(function(t){let e=t.target;return!e||(!e.closest(".woocommerce-cart-form input[type=number]")||void gtm4wp_handle_cart_qty_change())}))),gtm4wp_is_checkout&&(window.gtm4wp_checkout_step_offset=window.gtm4wp_checkout_step_offset||0,window.gtm4wp_checkout_value=window.gtm4wp_checkout_value||0,window.gtm4wp_checkout_products=window.gtm4wp_checkout_products||[],window.gtm4wp_checkout_products_ga4=window.gtm4wp_checkout_products_ga4||[],document.addEventListener("focusout",(function(t){let e=t.target;return!e||(!e.closest||!e.closest("input[name^=shipping_]:not(input[name^=shipping_method])")||void(gtm4wp_checkout_step_fired.indexOf("shipping")>-1||""!=e.value.trim()&&(window[gtm4wp_datalayer_name].push({event:"gtm4wp.checkoutStepEEC",ecommerce:{currencyCode:gtm4wp_currency,checkout:{actionField:{step:2+window.gtm4wp_checkout_step_offset},products:window.gtm4wp_checkout_products}}}),gtm4wp_checkout_step_fired.push("shipping"))))})),document.addEventListener("change",(function(t){let e=t.target;return!e||(!e.closest("input[name^=shipping_method]")||void gtm4wp_handle_shipping_method_change())})),document.addEventListener("change",(function(t){let e=t.target;return!e||(!e.closest("input[name=payment_method]")||void gtm4wp_handle_payment_method_change())})),document.addEventListener("submit",(function(t){let e=t.target;if(!e)return!0;if(!e.closest("form[name=checkout]"))return!0;-1==gtm4wp_checkout_step_fired.indexOf("shipping_method")&&gtm4wp_handle_shipping_method_change(),-1==gtm4wp_checkout_step_fired.indexOf("payment_method")&&gtm4wp_handle_payment_method_change();let r=document.querySelector("input[name^=shipping_method]:checked");r||(r=document.querySelector("input[name^=shipping_method]")),r&&window[gtm4wp_datalayer_name].push({event:"gtm4wp.checkoutOptionEEC",ecommerce:{checkout_option:{actionField:{step:3+window.gtm4wp_checkout_step_offset+gtm4wp_shipping_payment_method_step_offset,option:"Shipping: "+r.value}}}});let c=document.querySelector(".payment_methods input:checked");c||(c=document.querySelector("input[name^=payment_method]")),c&&window[gtm4wp_datalayer_name].push({event:"gtm4wp.checkoutOptionEEC",ecommerce:{checkout_option:{actionField:{step:4+window.gtm4wp_checkout_step_offset+gtm4wp_shipping_payment_method_step_offset,option:"Payment: "+c.value}}}})}))),window.gtm4wp_remarketing&&!gtm4wp_is_cart&&!gtm4wp_is_checkout&&jQuery(".gtm4wp_productdata").length>0){for(r=0;r<window[gtm4wp_datalayer_name].length&&!window[gtm4wp_datalayer_name][r].ecomm_prodid;r++);var c;if(r==window[gtm4wp_datalayer_name].length&&(r=0,window[gtm4wp_datalayer_name][r].ecomm_prodid=[]),void 0!==window[gtm4wp_datalayer_name][r].ecomm_prodid.push)jQuery(".gtm4wp_productdata").each((function(){c=jQuery(this),window[gtm4wp_datalayer_name][r].ecomm_prodid.push(gtm4wp_id_prefix+c.data("gtm4wp_product_id"))}))}window[gtm4wp_datalayer_name]&&window[gtm4wp_datalayer_name].forEach&&window[gtm4wp_datalayer_name].forEach((function(t){if(t&&t.ecommerce&&t.ecommerce.detail&&window[gtm4wp_datalayer_name].push({event:"view_item",ecommerce:{currency:gtm4wp_currency,value:t.ecommerce.detail.products[0].price,items:[gtm4wp_map_eec_to_ga4(t.ecommerce.detail.products[0])]}}),t&&t.ecommerce&&(t.ecommerce.cart||t.ecommerce.checkout&&gtm4wp_is_cart)){let e=t.ecommerce.cart||t.ecommerce.checkout.products,r=[],c=0;e.forEach((function(t){r.push(gtm4wp_map_eec_to_ga4(t)),c+=t.price*t.quantity})),window[gtm4wp_datalayer_name].push({event:"view_cart",ecommerce:{currency:gtm4wp_currency,value:c.toFixed(2),items:r}})}if(t&&t.ecommerce&&t.ecommerce.checkout&&!gtm4wp_is_cart){let e=[],r=0;t.ecommerce.checkout.products.forEach((function(t){e.push(gtm4wp_map_eec_to_ga4(t)),r+=t.price*t.quantity})),window[gtm4wp_datalayer_name].push({event:"begin_checkout",ecommerce:{currency:gtm4wp_currency,value:r,items:e}})}if(t&&t.ecommerce&&t.ecommerce.add){let e=[],r=0;t.ecommerce.add.products.forEach((function(t){e.push(gtm4wp_map_eec_to_ga4(t)),r+=t.price*t.quantity})),window[gtm4wp_datalayer_name].push({event:"add_to_cart",ecommerce:{currency:gtm4wp_currency,value:r,items:e}})}if(t&&t.ecommerce&&t.ecommerce.purchase){let e=[];t.ecommerce.purchase.products.forEach((function(t){e.push(gtm4wp_map_eec_to_ga4(t))})),window[gtm4wp_datalayer_name].push({event:"purchase",ecommerce:{currency:gtm4wp_currency,items:e,transaction_id:t.ecommerce.purchase.actionField.id,affiliation:t.ecommerce.purchase.actionField.affiliation,value:t.ecommerce.purchase.actionField.revenue,tax:t.ecommerce.purchase.actionField.tax,shipping:t.ecommerce.purchase.actionField.shipping,coupon:t.ecommerce.purchase.actionField.coupon}})}}))}function gtm4wp_page_loading_completed(){document.removeEventListener("DOMContentLoaded",gtm4wp_page_loading_completed),window.removeEventListener("load",gtm4wp_page_loading_completed),gtm4wp_process_woocommerce_pages()}window.gtm4wp_last_selected_product_variation,window.gtm4wp_changedetail_fired_during_pageload=!1,window.gtm4wp_is_cart=!1,window.gtm4wp_is_checkout=!1,window.gtm4wp_checkout_step_fired=[],window.gtm4wp_shipping_payment_method_step_offset=gtm4wp_needs_shipping_address?0:-1,window.gtm4wp_first_container_id="","loading"!==document.readyState?window.setTimeout(gtm4wp_process_woocommerce_pages):(document.addEventListener("DOMContentLoaded",gtm4wp_page_loading_completed),window.addEventListener("load",gtm4wp_page_loading_completed));